[
  {
    "inputs": [],
    "stateMutability": "nonpayable",
    "type": "constructor"
  },
  {
    "inputs": [],
    "name": "InvalidAddress",
    "type": "error"
  },
  {
    "inputs": [],
    "name": "Unauthorized",
    "type": "error"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "bytes32",
        "name": "subject",
        "type": "bytes32"
      },
      {
        "indexed": true,
        "internalType": "bytes32",
        "name": "anomalyType",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "internalType": "uint8",
        "name": "severity",
        "type": "uint8"
      },
      {
        "indexed": false,
        "internalType": "bytes32",
        "name": "detailsHash",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "internalType": "uint64",
        "name": "timestamp",
        "type": "uint64"
      }
    ],
    "name": "AnomalyFlagged",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "bytes32",
        "name": "anomalyId",
        "type": "bytes32"
      },
      {
        "indexed": true,
        "internalType": "address",
        "name": "resolver",
        "type": "address"
      },
      {
        "indexed": false,
        "internalType": "uint64",
        "name": "timestamp",
        "type": "uint64"
      }
    ],
    "name": "AnomalyResolved",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "address",
        "name": "previousOwner",
        "type": "address"
      },
      {
        "indexed": true,
        "internalType": "address",
        "name": "newOwner",
        "type": "address"
      }
    ],
    "name": "OwnershipTransferred",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "internalType": "address",
        "name": "account",
        "type": "address"
      }
    ],
    "name": "Paused",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      },
      {
        "indexed": false,
        "internalType": "uint256",
        "name": "maxOrderAmount",
        "type": "uint256"
      },
      {
        "indexed": false,
        "internalType": "uint256",
        "name": "maxOrdersPerHour",
        "type": "uint256"
      },
      {
        "indexed": false,
        "internalType": "uint256",
        "name": "maxDailyVolume",
        "type": "uint256"
      },
      {
        "indexed": false,
        "internalType": "uint16",
        "name": "maxRefundRateBps",
        "type": "uint16"
      },
      {
        "indexed": false,
        "internalType": "uint64",
        "name": "timestamp",
        "type": "uint64"
      }
    ],
    "name": "RuleSetUpdated",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": true,
        "internalType": "bytes32",
        "name": "txRef",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "internalType": "bytes32",
        "name": "reasonHash",
        "type": "bytes32"
      },
      {
        "indexed": false,
        "internalType": "uint64",
        "name": "timestamp",
        "type": "uint64"
      }
    ],
    "name": "TransactionBlocked",
    "type": "event"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "internalType": "address",
        "name": "account",
        "type": "address"
      }
    ],
    "name": "Unpaused",
    "type": "event"
  },
  {
    "inputs": [],
    "name": "DEFAULT_MAX_DAILY_VOLUME",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "DEFAULT_MAX_ORDERS_PER_HOUR",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "DEFAULT_MAX_ORDER_AMOUNT",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "DEFAULT_MAX_REFUND_RATE_BPS",
    "outputs": [
      {
        "internalType": "uint16",
        "name": "",
        "type": "uint16"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "anomalies",
    "outputs": [
      {
        "internalType": "bytes32",
        "name": "subject",
        "type": "bytes32"
      },
      {
        "internalType": "bytes32",
        "name": "anomalyType",
        "type": "bytes32"
      },
      {
        "internalType": "uint8",
        "name": "severity",
        "type": "uint8"
      },
      {
        "internalType": "bytes32",
        "name": "detailsHash",
        "type": "bytes32"
      },
      {
        "internalType": "uint64",
        "name": "timestamp",
        "type": "uint64"
      },
      {
        "internalType": "bool",
        "name": "resolved",
        "type": "bool"
      },
      {
        "internalType": "address",
        "name": "resolvedBy",
        "type": "address"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "txRef",
        "type": "bytes32"
      },
      {
        "internalType": "bytes32",
        "name": "reasonHash",
        "type": "bytes32"
      }
    ],
    "name": "blockTransaction",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "",
        "type": "bytes32"
      }
    ],
    "name": "blockedTransactions",
    "outputs": [
      {
        "internalType": "bool",
        "name": "",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      },
      {
        "internalType": "bytes16",
        "name": "orderId",
        "type": "bytes16"
      },
      {
        "internalType": "uint256",
        "name": "amount",
        "type": "uint256"
      }
    ],
    "name": "checkOrderAnomaly",
    "outputs": [
      {
        "internalType": "bool",
        "name": "isAnomaly",
        "type": "bool"
      },
      {
        "internalType": "uint8",
        "name": "severity",
        "type": "uint8"
      },
      {
        "internalType": "string",
        "name": "recommendedAction",
        "type": "string"
      }
    ],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      },
      {
        "internalType": "bytes16",
        "name": "orderId",
        "type": "bytes16"
      },
      {
        "internalType": "uint256",
        "name": "refundAmount",
        "type": "uint256"
      }
    ],
    "name": "checkRefundAnomaly",
    "outputs": [
      {
        "internalType": "bool",
        "name": "isAnomaly",
        "type": "bool"
      }
    ],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "name": "dailyStats",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "totalOrders",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "totalVolumeUsd6",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "refundCount",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "startDate",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "subject",
        "type": "bytes32"
      },
      {
        "internalType": "bytes32",
        "name": "anomalyType",
        "type": "bytes32"
      },
      {
        "internalType": "uint8",
        "name": "severity",
        "type": "uint8"
      },
      {
        "internalType": "bytes32",
        "name": "detailsHash",
        "type": "bytes32"
      }
    ],
    "name": "flagAnomaly",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "anomalyId",
        "type": "bytes32"
      }
    ],
    "name": "getAnomaly",
    "outputs": [
      {
        "components": [
          {
            "internalType": "bytes32",
            "name": "subject",
            "type": "bytes32"
          },
          {
            "internalType": "bytes32",
            "name": "anomalyType",
            "type": "bytes32"
          },
          {
            "internalType": "uint8",
            "name": "severity",
            "type": "uint8"
          },
          {
            "internalType": "bytes32",
            "name": "detailsHash",
            "type": "bytes32"
          },
          {
            "internalType": "uint64",
            "name": "timestamp",
            "type": "uint64"
          },
          {
            "internalType": "bool",
            "name": "resolved",
            "type": "bool"
          },
          {
            "internalType": "address",
            "name": "resolvedBy",
            "type": "address"
          }
        ],
        "internalType": "struct FraudDetection.AnomalyData",
        "name": "anomaly",
        "type": "tuple"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      }
    ],
    "name": "getAnomalyRules",
    "outputs": [
      {
        "components": [
          {
            "internalType": "uint256",
            "name": "maxOrderAmount",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "maxOrdersPerHour",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "maxDailyVolume",
            "type": "uint256"
          },
          {
            "internalType": "uint16",
            "name": "maxRefundRateBps",
            "type": "uint16"
          },
          {
            "internalType": "bool",
            "name": "customRulesEnabled",
            "type": "bool"
          }
        ],
        "internalType": "struct FraudDetection.RuleSet",
        "name": "rules",
        "type": "tuple"
      },
      {
        "internalType": "bool",
        "name": "customEnabled",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      }
    ],
    "name": "getReputationScore",
    "outputs": [
      {
        "internalType": "uint8",
        "name": "score",
        "type": "uint8"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      }
    ],
    "name": "getRestaurantStats",
    "outputs": [
      {
        "components": [
          {
            "internalType": "uint256",
            "name": "ordersCount",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "volumeUsd6",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "startTime",
            "type": "uint256"
          }
        ],
        "internalType": "struct FraudDetection.HourlyVolume",
        "name": "hourly",
        "type": "tuple"
      },
      {
        "components": [
          {
            "internalType": "uint256",
            "name": "totalOrders",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "totalVolumeUsd6",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "refundCount",
            "type": "uint256"
          },
          {
            "internalType": "uint256",
            "name": "startDate",
            "type": "uint256"
          }
        ],
        "internalType": "struct FraudDetection.DailyStats",
        "name": "daily",
        "type": "tuple"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "name": "governance",
    "outputs": [
      {
        "internalType": "bool",
        "name": "",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "name": "hourlyVolume",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "ordersCount",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "volumeUsd6",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "startTime",
        "type": "uint256"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "txRef",
        "type": "bytes32"
      }
    ],
    "name": "isBlocked",
    "outputs": [
      {
        "internalType": "bool",
        "name": "blocked",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "owner",
    "outputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "pause",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "paused",
    "outputs": [
      {
        "internalType": "bool",
        "name": "",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "renounceOwnership",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "bytes32",
        "name": "anomalyId",
        "type": "bytes32"
      }
    ],
    "name": "resolveAnomaly",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "",
        "type": "address"
      }
    ],
    "name": "restaurantRules",
    "outputs": [
      {
        "internalType": "uint256",
        "name": "maxOrderAmount",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "maxOrdersPerHour",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "maxDailyVolume",
        "type": "uint256"
      },
      {
        "internalType": "uint16",
        "name": "maxRefundRateBps",
        "type": "uint16"
      },
      {
        "internalType": "bool",
        "name": "customRulesEnabled",
        "type": "bool"
      }
    ],
    "stateMutability": "view",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "account",
        "type": "address"
      },
      {
        "internalType": "bool",
        "name": "isGovernance",
        "type": "bool"
      }
    ],
    "name": "setGovernance",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "newOwner",
        "type": "address"
      }
    ],
    "name": "transferOwnership",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [],
    "name": "unpause",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "inputs": [
      {
        "internalType": "address",
        "name": "restaurant",
        "type": "address"
      },
      {
        "internalType": "uint256",
        "name": "maxOrderAmount",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "maxOrdersPerHour",
        "type": "uint256"
      },
      {
        "internalType": "uint256",
        "name": "maxDailyVolume",
        "type": "uint256"
      },
      {
        "internalType": "uint16",
        "name": "maxRefundRateBps",
        "type": "uint16"
      }
    ],
    "name": "updateRestaurantRules",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
  }
]